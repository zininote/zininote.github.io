---
layout: post
title: "VLOOKUP: 오른쪽열 기준으로 보다 왼쪽열 내용 VLOOKUP 검색"
updated: 2021-05-03
tags: [msoffice,excel]
---

## VLOOKUP 검색범위의 문제

VLOOKUP 함수의 일반적인 사용법은 아래와 같다.

```excel
= VLOOKUP( 검색값, 검색범위, 열번호, 작동방식 )
```
{:.excel}

`검색범위`를 지정하면, 그 범위의 가장 왼쪽열을 "검색기준열" 로 강제하고, `열번호`만큼 떨어진 지점을 "검색대상열" 로 삼는다. 따라서 왼쪽열을 기준으로 오른쪽열 내용을 검색할 수밖에 없다.

하지만 오른쪽열 기준으로 보다 왼쪽열 내용을 검색할 수 있는 방법이 아예 없는 것은 아니다. 아래에 몇개 방법을 소개하였는데, 공통점은 "검색기준열" 과 "검색대상열" 을 따로 만들어 검색을 한다.

## INDEX, MATCH 함수조합 사용

![그림00](/img/msoffice/msoffice-2210-01-01-00.png)

```excel
= INDEX( 검색대상열, MATCH( 검색값, 검색기준열, 0 ))
```
{:.excel}

VLOOKUP 대신 INDEX, MATCH 함수를 사용하여 동일한 기능을 구현할 수 있다. 게다가 INDEX, MATCH 는 `검색기준열`과 `검색대상열`을 별도로 지정할 수 있기 때문에, 보다 유연한 검색이 가능하다.

`검색값`에 해당하는 위치를 MATCH 함수가 찾아, INDEX 함수에 전달하는 구조다. 공식처럼 외워두면 편리하다.

## CHOOSE 함수로 가상범위 생성

![그림01](/img/msoffice/msoffice-2210-01-01-01.png)

```excel
= VLOOKUP( 검색값, CHOOSE( {1, 2}, 검색기준열, 검색대상열 ), 2, FALSE )
```

CHOOSE 는 본래 첫번째 인수에 번호 n 을 지정하면, 뒤 이어진 인수들 중에서 n 번째 인수를 반환하는 함수다. 그러나 위 함수식처럼 `{1, 2}` 라는 표현이 들어가면, 뒤이어진 인수들(여기서는 `검색기준열`과 `검색대상열`)로 가상의 범위를 만들어낸다. 이 가상의 범위를 바탕으로 VLOOKUP 함수를 사용한다고 보면 된다.