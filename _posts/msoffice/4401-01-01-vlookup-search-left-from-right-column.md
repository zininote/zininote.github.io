---
layout: post
title: "VLOOKUP: 오른쪽열 기준으로 보다 왼쪽열 내용 검색"
updated: 2021-01-17
tags: [msoffice,excel]
---

## VLOOKUP 단점

VLOOKUP 은 Excel 사용에 있어서 없어서는 안될 요긴한 함수이지만, 아쉬운 점이 몇가지 있다. 그 중 하나는, 검색범위를 지정했을 때, 항상 검색기준열이 검색범위의 가장 왼쪽열로 고정된다는 점이다. 이런 특징 때문에, 지정한 검색범위보다 왼쪽에 있는 내용을 검색대상으로 삼을 수가 없다.

하지만 방법이 없는 것은 아닌데, 아래에서 소개해보고자 한다.

## 오른쪽열 기준으로 왼쪽열 내용 검색

```excel
= VLOOKUP(검색값, CHOOSE({1, 2}, 검색기준열, 검색대상열), 2, FALSE)
```
{:.excel}

![그림00](/img/msoffice/excel-4401-01-01-00.png)

오른쪽에 있는 "담당자"를 기준으로, 보다 왼쪽에 있는 "매출액" 내용을 검색하고 있다.

VLOOKUP 함수 내부를보면 CHOOSE 함수가 사용되어 있음을 볼 수 있다. CHOOSE 함수의 첫번재 인수를 `{1, 2}`와 같은 형태로 두고, 그 뒤로 어떤 범위를 지정하면, CHOOSE 함수는 범위들로 이뤄진 새로운 가상범위를 생성해낸다. 이 가상의 범위에 VLOOKUP 함수를 적용한다고 보면 된다.

구체적으로 CHOOSE 가 생성하는 가상범위는 `검색기준열`과 `검색대상열`이 가상범위로 조립되는 형태다. `검색기준열`이 가장 왼쪽열이 되며, `검색대상열`이 두번째 열이 된다. 그래서 `열번호`에 2 를 적용하고 VLOOKUP 함수를 사용했다고 생각하면 된다.

`검색기준열`과 `검색대상열`을 독립적으로 지정할 수 있기에, 오른쪽이든 왼쪽이든 위치에 관계없이 자유로운 검색이 가능하다.

## 참고

INDEX-MATCH 함수 조합으로 VLOOKUP 함수를 대신할 수 있다. 이 포스팅에서 소개한 보다 왼쪽에 있는 내용 검색도 가능하다. 관심있는 분들은 아래 포스팅을 참고해보기 바란다.

- [INDEX, MATCH: VLOOKUP 의 대안, INDEX-MATCH 함수](post/index-match-vlookup-alternative)