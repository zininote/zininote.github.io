---
layout: post
title: "VLOOKUP: 두가지 이상 기준으로 검색"
updated: 2021-01-18
tags: [msoffice,excel]
---

## VLOOKUP 단점

VLOOKUP 함수는 Excel 에서 자주 사용되는 함수지만, 사용에 다소 불편한 점들이 몇개 있는데, 그 중 하나는 오직 한개의 기준으로만 검색이 가능하다는 점이다.

하지만 방법이 아주 없는 것은 아닌데, 이 포스팅에서 두가지 이상 기준으로 검색하는 방법을 2개 소개해보고자 한다.

## Helper 열을 사용하는 방법

```excel
= VLOOKUP(검색값1&검색값2, 검색범위, 열번호, FALSE)
```

![그림00](/img/excel-4402-01-01-00.png)

위 그림에서 B 열이 Helper 열이다. 검색을 원하는 열들을 & 연산자로 묶었음을 알 수 있다. 그리고 VLOOKUP 함수에서는 이 Helper 열을 포함하여 `검색범위`를 설정한다. 또한 `검색값`들도 & 연산자로 묶어서 검색한다.

VLOOKUP 함수의 규칙을 깨지 않고, Helper 라는 트릭을 써서 검색하는 방식이다. 응용하면 세가지 이상 기준으로도 검색이 가능하다.

## 배열수식을 사용하는 방법

```excel
= VLOOKUP(검색값1&검색값2, CHOOSE({1, 2}, 검색기준열1&검색기준열2, 검색대상열), 2, FALSE)
```

반드시 **배열수식**으로 입력해야 정상 작동한다.

![그림01](/img/excel-4402-01-01-01.png)

Helper 열이 필요없는 대신 수식이 복잡하다. CHOOSE 함수의 첫번째 인수를 `{1, 2}` 형태로 두면, 이후에 나오는 범위를 조합하여 가상범위를 생성한다. 이 가상범위에 VLOOKUP 함수를 적용한다고 보면 된다.

## 참고

VLOOKUP 함수 대신 INDEX-MATCH 함수 조합을 사용할 수 있다. 아래 포스팅은 이를 소개한 것으로 관심있으신 분들은 참고해보길 바란다.

- [INDEX, MATCH: VLOOKUP 의 대안, INDEX-MATCH 함수](/post/index-match-vlookup-alternative)